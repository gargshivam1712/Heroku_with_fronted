<!DOCTYPE html>
<html>
<head>
	<title>Fetch_Repo</title>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
<script>


$(document).ready(function(){
	$('#submit').click(function(){
		$("#div1").val("");

		var username=$("#username").val();

		var requri   = 'https://api.github.com/users/'+username;
		var repouri  = 'https://api.github.com/users/'+username+'/repos';
		$.getJSON(requri,function(data){	
		var fullname   = data.name;
		var username   =data.login;
        var aviurl     = data.avatar_url;
        var profileurl = data.html_url;
        var location   = data.location;
        var followersnum = data.followers;
        var followingnum = data.following;
        var reposnum     = data.public_repos;
		if(fullname == undefined) { fullname = username; }
		var outhtml = '<h2>'+fullname+' <span class="smallname">(@<a href="'+ profileurl+'" target="_blank">'+username+'</a>)</span></h2>';
        	outhtml = outhtml + '<div style="display: flex;margin-top: 20px;margin-bottom: 20px;"><a style="margin-right:20px;" href="'+profileurl+'" target="_blank"><img src="'+aviurl+'" width="80" height="80" alt="'+username+'"></a>';
        	outhtml = outhtml + '<p>Followers: '+followersnum+' - Following: '+followingnum+'<br>Repos: '+reposnum+'</p></div>';
        	outhtml = outhtml + '<div>';
			var repositories;
    		$.getJSON(repouri, function(json){
            repositories = json;   
            outputPageContent();                
        	});          
        
	        function outputPageContent() {
	          if(repositories.length == 0) { outhtml = outhtml + '<p>No repos!</p></div>'; }
	          else {
	            outhtml = outhtml + '<p><strong>Repos List:</strong></p>';
	            $.each(repositories, function(index) {
	              outhtml = outhtml + '<button style="margin:3px;" class="btn btn-primary"><a style="color:white;" href="'+repositories[index].html_url+'" target="_blank">'+repositories[index].name + '</a></button>';
	            });
	            outhtml = outhtml + '</div>'; 
	          	}
	          	$('#div1').html(outhtml);
	        } // end outputPageContent()

			}).fail(function( jqxhr, textStatus, error ) {
				if (error=='Not Found'){
				var outhtml='<h2>Your username: <b>'+username+'</b> is not correct</h2>'	
				}
		    $('#div1').html(outhtml);
			});
			$("#username").val("");
		});
	});
</script>
</head>
<body style="background-color:#696969d9;">

	<div class="container" style="background-color: lightgray;width: 700px;
	position: relative;margin-top: 60px;padding: 20px;">
		<h1>Simple Github API Webapp</h1>
		<p>Enter a single Github username below and click the button to display repository.</p>
	<input type="text" id="username" name="username" placeholder="enter username" style="width:60%; padding: 5px; margin-bottom: 5px;"  />
	<button id='submit' class="button" style="padding: 5px;">Search</button>
	<div id="div1"></div>
</div>
</body>
</html>
